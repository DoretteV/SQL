-- This script was generated by the ERD tool in pgAdmin 4.
-- Please log an issue at https://redmine.postgresql.org/projects/pgadmin4/issues/new if you find any bugs, including reproduction steps.
BEGIN;


CREATE TABLE IF NOT EXISTS public."Employees"
(
    emp_id integer NOT NULL,
    first_name character varying(50) NOT NULL,
    surname character varying(50) NOT NULL,
    gender character varying(1) NOT NULL,
    address character varying(128) NOT NULL,
    email character varying(128) NOT NULL,
    depart_id integer NOT NULL,
    role_id integer NOT NULL,
    salary_id integer NOT NULL,
    overtime_id integer NOT NULL,
    PRIMARY KEY (emp_id)
);

CREATE TABLE IF NOT EXISTS public."Department"
(
    depart_id integer NOT NULL,
    depart_name character varying(50) NOT NULL,
    depart_city character varying(50) NOT NULL
);

CREATE TABLE IF NOT EXISTS public."Roles"
(
    role_id integer NOT NULL,
    role character varying NOT NULL
);

CREATE TABLE IF NOT EXISTS public."Salaries"
(
    salary_id integer NOT NULL,
    salary_pa integer NOT NULL
);

CREATE TABLE IF NOT EXISTS public."Overtime Hours"
(
    overtime_id integer NOT NULL,
    overtime_hours numeric NOT NULL
);

ALTER TABLE IF EXISTS public."Employees"
    ADD FOREIGN KEY (depart_id)
    REFERENCES public."Department" (depart_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Employees"
    ADD FOREIGN KEY (role_id)
    REFERENCES public."Roles" (role_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Employees"
    ADD FOREIGN KEY (salary_id)
    REFERENCES public."Salaries" (salary_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;


ALTER TABLE IF EXISTS public."Employees"
    ADD FOREIGN KEY (overtime_id)
    REFERENCES public."Overtime Hours" (overtime_id) MATCH SIMPLE
    ON UPDATE NO ACTION
    ON DELETE NO ACTION
    NOT VALID;

INSERT INTO public."Employees" (emp_id, first_name, surname, gender, address, email, depart_id, role_id, salary_id, overtime_id)
VALUES	('1', 'Chris', 'Frost', 'M', '10 Protea Street, Gauteng', 'cfrost@gmail.com', 10, 11, 12, 13),
		('2', 'Mandy', 'Clark', 'F', '258 Rose Avenue, Rustenburg', 'mclark@gmail.com', 20, 21, 22, 23),
		('3', 'Peter', 'Short', 'M', '26 Lily Avenue, Cape Town', 'pshort@gmail.com', 30, 31, 32, 33),
		('4', 'Beth', 'Dutton', 'F', '8 Oak Tree Place, Eastern Cape', 'bdutton@gmail.com', 40, 41, 42, 43);

SELECT * FROM public."Employees"

INSERT INTO public."Department" (depart_id, depart_name, depart_city)
VALUES ('10', 'Marketing', 'East London'),
        ('20', 'Technology', 'Gauteng'),
        ('30', 'Finance', 'Cape Town'),
        ('40', 'Quality Management', 'Rustenburg');

SELECT * FROM public."Department"

INSERT INTO public."Roles" (role_id, role) 
VALUES ('11', 'Digital Marketing'),
        ('21', 'Software Developer'),
        ('31', 'Auditor'),
        ('41', 'Quality Assurance');

SELECT * FROM public."Roles"

INSERT INTO public."Salaries" (salary_id, salary_pa)
VALUES ('12', 120000),
        ('22', 95000),
        ('32', 105000),
        ('42', 85000);

SELECT * FROM public."Salaries"

INSERT INTO public."Overtime Hours" (overtime_id, overtime_hours)
VALUES ('13', 15),
        ('23', 28),
        ('33', 45),
        ('43', 32);

SELECT * FROM public."Overtime Hours"

--  LEFT JOIN query that will display the department name, job title, salary figure and overtime hours worked

SELECT 
	e.emp_id,
	e.first_name,
	e.surname,
	d.depart_name AS department_name,
	r.role AS job_title,
	s.salary_pa AS salary_figure,
	o.overtime_hours AS overtime_hours_worked
FROM
    public."Employees" e
LEFT JOIN
    public."Department" d ON e.depart_id = d.depart_id
LEFT JOIN
    public."Roles" r ON e.role_id = r.role_id
LEFT JOIN
    public."Salaries" s ON e.salary_id = s.salary_id
LEFT JOIN
    public."Overtime Hours" o ON e.overtime_id = o.overtime_id;
	
END;